```markdown
# Member 資料
| Member_ID | Name | JoinDate |
| :--- | :--- | :--- |
| M0001 | Alice Wong | 2023-01-05 |
| M0002 | Ben Chan | 2023-02-10 |
| M0003 | Cathy Lee | 2023-03-12 |
| M0004 | David Lam | 2023-03-25 |
| M0005 | Emily Ng | 2023-04-08 |
| M0006 | Frank Ho | 2023-05-16 |
| M0007 | Grace Cheung | 2023-06-01 |
| M0008 | Henry Lee | 2023-06-22 |
| M0009 | Ivy Tang | 2023-07-10 |
| M0010 | Jack Lau | 2023-08-02 |

# Book 資料
| Book_ID | Title | Author |
| :--- | :--- | :--- |
| B001 | The Art of AI | John Smith |
| B002 | Python Basics | Laura Ng |
| B003 | Data Science 101 | Michael Chan |
| B004 | Learning SQL | Peter Wong |
| B005 | The Cloud Era | Angela Lee |
| B006 | Introduction to Robotics | David Ho |
| B007 | Creative Coding | Sarah Lam |
| B008 | Digital Photography | Chris Cheung |
| B009 | Cybersecurity Fundamentals | Raymond Kwok |
| B010 | Machine Learning Made Easy | Rachel Lee |
| B011 | Introduction to Databases | Pauline Yip |
| B012 | Understanding Algorithms | Ken Lau |
| B013 | Tech Entrepreneurship | Amy Wong |
| B014 | Blockchain Simplified | Nelson Cheng |
| B015 | AI and Society | Winnie Ng |

# Borrow 資料
| Member_ID | Book_ID | BorrowDate |
| :--- | :--- | :--- |
| M0001 | B001 | 2024-01-10 |
| M0001 | B003 | 2024-01-15 |
| M0002 | B002 | 2024-02-05 |
| M0002 | B010 | 2024-02-15 |
| M0003 | B005 | 2024-03-01 |
| M0003 | B011 | 2024-03-07 |
| M0004 | B006 | 2024-03-20 |
| M0005 | B015 | 2024-04-08 |
| M0006 | B007 | 2024-04-20 |
| M0006 | B008 | 2024-05-05 |
| M0007 | B012 | 2024-05-15 |
| M0008 | B014 | 2024-06-10 |
| M0009 | B001 | 2024-06-18 |
| M0010 | B002 | 2024-07-05 |
| M0010 | B003 | 2024-07-12 |
| M0004 | B010 | 2024-07-25 |
| M0005 | B011 | 2024-08-03 |
| M0007 | B005 | 2024-08-12 |
| M0008 | B015 | 2024-08-20 |
| M0009 | B006 | 2024-08-29 |

---

### **Instructions: Write SQL statements to answer each of the following questions based on the database tables: Member, Book, and Borrow.**

### **Part 1: Simple SQL Queries**

**1. List all books.**
```sql
SELECT * FROM Book;
```

**2. Display the names of all members who joined in 2023.**
```sql
SELECT Name 
FROM Member 
WHERE EXTRACT(YEAR FROM JoinDate) = 2023;
```

**3. Show the titles of books written by 'Rachel Lee'.**
```sql
SELECT Title 
FROM Book 
WHERE Author = 'Rachel Lee';
```

**4. Find the book ID of books borrowed after 1 July 2024.**
```sql
SELECT DISTINCT Book_ID 
FROM Borrow 
WHERE BorrowDate > '2024-07-01';
```

### **Part 2 : Join Tables**

**5. List the titles of all books together with the member names who borrowed them.**
```sql
SELECT b.Title, m.Name 
FROM Book b 
JOIN Borrow br ON b.Book_ID = br.Book_ID 
JOIN Member m ON br.Member_ID = m.Member_ID;
```

**6. Show all book titles and borrower names, including books not yet borrowed.**
```sql
SELECT b.Title, m.Name 
FROM Book b 
LEFT JOIN Borrow br ON b.Book_ID = br.Book_ID 
LEFT JOIN Member m ON br.Member_ID = m.Member_ID;
```

**7. Display each member and the number of books they borrowed.**
```sql
SELECT Member_ID, COUNT(Member_ID) 
FROM Borrow 
GROUP BY Member_ID;
```

### **Part 3 Aggregate Functions**

**8. Count how many books are in the library.**
```sql
SELECT COUNT(Book_ID) 
FROM Book;
```

**9. Find the earliest and latest borrow dates.**
```sql
SELECT MAX(BorrowDate) AS latest, MIN(BorrowDate) AS earliest 
FROM Borrow;
```

**10. Show how many distinct members have borrowed at least one book.**
```sql
SELECT COUNT(DISTINCT Member_ID) 
FROM Borrow;
```

**11. List each author and how many of their books have been borrowed.**
```sql
SELECT Author, COUNT(*) 
FROM Book bo 
INNER JOIN Borrow b ON b.Book_ID = bo.Book_ID 
GROUP BY Author;
```

### **Part 4 Subqueries**

**12. Find members who borrowed the book with ID 'B001'.**
```sql
SELECT Member_ID 
FROM Borrow 
WHERE Book_ID = 'B001';
```

**13. List books that have never been borrowed.**
```sql
SELECT b.BOOK_ID 
FROM Book b 
LEFT JOIN Borrow br ON b.Book_ID = br.Book_ID 
WHERE br.Book_ID IS NULL;```

**14. Show members who borrowed more than one book.**
```sql
SELECT MEMBER_ID, COUNT(*)
FROM BORROW
GROUP BY MEMBER_ID
HAVING COUNT(*) > 1;
```

**15. Find the titles of books borrowed by 'Alice Wong'.**
```sql
SELECT TITLE 
FROM BOOK
WHERE BOOK_ID IN
(SELECT BOOK_ID FROM BORROW WHERE MEMBER_ID IN
(SELECT MEMBER_ID FROM MEMBER WHERE NAME = 'Alice Wong'));
```
```
